{"paragraphs":[{"text":"%pyspark\n#Get all of our files that are properly formatted\nd=sc.textFile(\"s3a://twitter-streaming02062017/twitter2017/02/11/*/*\").flatMap(lambda x: x.split('/n'))","dateUpdated":"2017-02-17T01:26:47+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487287074528_1742971375","id":"20170216-231754_2142449566","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-02-16T23:17:54+0000","dateStarted":"2017-02-17T01:25:03+0000","dateFinished":"2017-02-17T01:25:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1037","focus":true},{"text":"%pyspark\ndef map_hashtag_to_num(x):\n    \"\"\" Input an individual tweet\n    Output: each hastag followed by the number one.\"\"\"\n    try:\n        entity = json.loads(x)\n        try:\n            entity = entity['entities']\n            if entity is not None and (entity['hashtags'] is not None\n                                            or len(entity['hashtags']) != 0):\n                for hashtags in entity['hashtags']:\n                    return(hashtags['text'].lower().encode('utf-8'), 1)\n            else:\n                pass\n        except KeyError:\n            pass\n    except ValueError:\n        pass","dateUpdated":"2017-02-17T01:25:05+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487287419831_-265344552","id":"20170216-232339_603608956","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-02-16T23:23:39+0000","dateStarted":"2017-02-17T01:25:05+0000","dateFinished":"2017-02-17T01:25:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1038","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487292013049_814223038","id":"20170217-004013_1013411222","dateCreated":"2017-02-17T00:40:13+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1754","text":"","dateUpdated":"2017-02-17T00:49:55+0000","dateFinished":"2017-02-17T00:48:21+0000","dateStarted":"2017-02-17T00:48:21+0000","result":{"code":"ERROR","type":"TEXT","msg":"\n\n\n<console>:27: error: not found: value %\n       %pyspark\n       ^\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487292011589_-507774182","id":"20170217-004011_598745591","dateCreated":"2017-02-17T00:40:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1684","text":"","dateUpdated":"2017-02-17T01:18:15+0000","dateFinished":"2017-02-17T01:12:33+0000","dateStarted":"2017-02-17T01:12:33+0000","result":{"code":"SUCCESS","type":"TEXT","msg":""}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487292011583_-491614729","id":"20170217-004011_152415549","dateCreated":"2017-02-17T00:40:11+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1614","text":"","dateUpdated":"2017-02-17T00:41:03+0000"},{"text":"%pyspark\n## filter out the lines that we could not convert due to bad JSON\nhash_num = d.map(map_hashtag_to_num).filter(lambda x: x != None)","dateUpdated":"2017-02-17T01:25:06+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487287425713_2000826470","id":"20170216-232345_1018639067","dateCreated":"2017-02-16T23:23:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1039","dateFinished":"2017-02-17T01:25:06+0000","dateStarted":"2017-02-17T01:25:06+0000","result":{"code":"SUCCESS","type":"TEXT","msg":""},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487290916277_-1872845190","id":"20170217-002156_2139220150","dateCreated":"2017-02-17T00:21:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1351","dateUpdated":"2017-02-17T01:25:08+0000","dateFinished":"2017-02-17T01:25:11+0000","dateStarted":"2017-02-17T01:25:08+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"[('philly', 1), ('iherb', 1), ('sanremo2017', 1), ('rt\\xe3\\x81\\x8f\\xe3\\x82\\x8c\\xe3\\x81\\x9fnews\\xe6\\x8b\\x85\\xe3\\x81\\xa7\\xe6\\xb0\\x97\\xe3\\x81\\xab\\xe3\\x81\\xaa\\xe3\\x81\\xa3\\xe3\\x81\\x9f\\xe6\\x96\\xb9\\xe3\\x81\\x8a\\xe8\\xbf\\x8e\\xe3\\x81\\x88\\xe3\\x81\\x84\\xe3\\x81\\x8d\\xe3\\x81\\xbe\\xe3\\x81\\x99', 1), ('\\xe0\\xb8\\x99\\xe0\\xb8\\xb1\\xe0\\xb8\\x81\\xe0\\xb9\\x80\\xe0\\xb8\\xa3\\xe0\\xb8\\xb5\\xe0\\xb8\\xa2\\xe0\\xb8\\x99\\xe0\\xb9\\x81\\xe0\\xb8\\xa5\\xe0\\xb8\\x81\\xe0\\xb9\\x80\\xe0\\xb8\\x9b\\xe0\\xb8\\xa5\\xe0\\xb8\\xb5\\xe0\\xb9\\x88\\xe0\\xb8\\xa2\\xe0\\xb8\\x99', 1), ('\\xd8\\xb3\\xd8\\xb9\\xd9\\x88\\xd8\\xaf\\xd9\\x8a\\xd8\\xa7\\xd8\\xaa_\\xd9\\x86\\xd8\\xb7\\xd9\\x84\\xd8\\xa8_\\xd8\\xa7\\xd8\\xb3\\xd9\\x82\\xd8\\xa7\\xd8\\xb7_\\xd8\\xa7\\xd9\\x84\\xd9\\x88\\xd9\\x84\\xd8\\xa7\\xd9\\x8a\\xd9\\x87219', 1), ('truth', 1), ('\\xec\\x82\\xac\\xeb\\x8b\\xa4\\xeb\\xa6\\xac\\xeb\\x86\\x80\\xec\\x9d\\xb4\\xed\\x84\\xb0', 1), ('btc', 1)]\n"},"text":"%pyspark\n## Test to make sure our function is working\nhash_num.take(9)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487291552238_-1112109603","id":"20170217-003232_631951312","dateCreated":"2017-02-17T00:32:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1499","dateUpdated":"2017-02-17T01:25:16+0000","dateFinished":"2017-02-17T01:25:16+0000","dateStarted":"2017-02-17T01:25:16+0000","result":{"code":"SUCCESS","type":"TEXT","msg":""},"text":"%pyspark\nhash_num_agg = hash_num.reduceByKey(lambda a, b:a+b)\n    "},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487292211034_-1333000921","id":"20170217-004331_2052449591","dateCreated":"2017-02-17T00:43:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1830","dateUpdated":"2017-02-17T01:26:37+0000","dateFinished":"2017-02-17T01:26:37+0000","dateStarted":"2017-02-17T01:26:37+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"[('\\xd1\\x81\\xd0\\xba\\xd0\\xb0\\xd1\\x87\\xd0\\xb0\\xd1\\x82\\xd1\\x8c', 11), ('essay', 8), ('\\xe3\\x82\\xa2\\xe3\\x83\\x80\\xe3\\x83\\xab\\xe3\\x83\\x88\\xe9\\x9b\\x91\\xe8\\xaa\\x8c\\xe3\\x83\\xbbav\\xe8\\xa1\\xa8\\xe7\\xb4\\x99\\xe3\\x82\\xb3\\xe3\\x83\\xa9', 1), ('celticfamily', 1), ('\\xd8\\xa7\\xd9\\x84\\xd9\\x82\\xd9\\x88\\xd8\\xa7\\xd8\\xaa_\\xd8\\xa7\\xd9\\x84\\xd8\\xa7\\xd9\\x85\\xd9\\x86\\xd9\\x8a\\xd9\\x87', 2), ('alphapartners', 1), ('koffeewithkaran', 1), ('\\xe3\\x83\\x94\\xe3\\x83\\xa5\\xe3\\x83\\xbc\\xe3\\x83\\xad\\xe3\\x82\\xa2\\xe3\\x83\\xb3\\xe3\\x83\\x90\\xe3\\x82\\xb5\\xe3\\x83\\x80\\xe3\\x83\\xbc', 1), ('team\\xe3\\x81\\x9f\\xe3\\x81\\xae\\xe3\\x81\\xa3\\xe3\\x81\\x97\\xe3\\x83\\xbc\\xe3\\x83\\xa4\\xe3\\x83\\x9e\\xe3\\x83\\x81\\xe3\\x83\\xa3\\xe3\\x82\\xad', 1), ('joshua', 11)]\n"},"text":"%pyspark\n# Now we have each hashtag with the number of times it occurs\nhash_num_agg.take(10)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487292223919_809696352","id":"20170217-004343_1622204286","dateCreated":"2017-02-17T00:43:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1900","dateUpdated":"2017-02-17T01:26:40+0000","dateFinished":"2017-02-17T01:26:41+0000","dateStarted":"2017-02-17T01:26:40+0000","result":{"code":"SUCCESS","type":"TEXT","msg":""},"text":"%pyspark\n# Next, sort this by the top hashtags\ntop_hash_sorted = hash_num_agg.takeOrdered(10, key=lambda x: -x[1])"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487293668866_1841826054","id":"20170217-010748_1137248189","dateCreated":"2017-02-17T01:07:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2233","dateUpdated":"2017-02-17T01:26:42+0000","dateFinished":"2017-02-17T01:26:42+0000","dateStarted":"2017-02-17T01:26:42+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"[('\\xd8\\xaa\\xd9\\x88\\xd9\\x82_\\xd8\\xa7\\xd9\\x84\\xd8\\xa7\\xd8\\xb9\\xd8\\xb5\\xd8\\xa7\\xd8\\xb1_\\xd8\\xaa\\xd9\\x88\\xd9\\x8a\\xd8\\xaa_\\xd9\\x87\\xd9\\x88\\xd8\\xb3\\xd8\\xaa', 9438), ('kcapinoystar', 8135), ('aldubxdtbysinjie', 5086), ('kcaestrellalatina', 2840), ('thefacethailandseason3', 2220), ('kcapersonalidadebr', 1878), ('lovatics', 1798), ('nowplaying', 1651), ('izmirescort', 1545), ('bbb17', 1362)]\n"},"text":"%pyspark\n## Top ten results\ntop_hash_sorted"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487293711613_1141475786","id":"20170217-010831_1746594681","dateCreated":"2017-02-17T01:08:31+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2317","dateUpdated":"2017-02-17T01:08:50+0000","text":""}],"name":"lab-5.2-Jonathan-Hilgart","id":"2C8A9UKMP","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}