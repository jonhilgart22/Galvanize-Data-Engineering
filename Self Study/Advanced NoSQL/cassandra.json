{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481663379250_-542336002","id":"20161213-210939_986450241","dateCreated":"2016-12-13T21:09:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6394","text":"%pyspark\ntry:\n    import json\nexcept ImportError:\n    import simplejson as json\n    \nfrom cassandra.cluster import Cluster","dateUpdated":"2016-12-13T22:15:54+0000","dateFinished":"2016-12-13T22:14:41+0000","dateStarted":"2016-12-13T22:14:41+0000","result":{"code":"SUCCESS","type":"TEXT","msg":""},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481667316896_2073041405","id":"20161213-221516_1468432571","dateCreated":"2016-12-13T22:15:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6707","text":"%pyspark\ntweets = sc.textFile(\"s3a://kinesis-lab5/2016/*/*/*\")\ntweets = tweets.filter(lambda v: len(v) > 44)\ntweets = tweets.flatMap(lambda s: s.replace('}{', '}\\n{').split('\\n'))","dateUpdated":"2016-12-13T22:15:41+0000","dateFinished":"2016-12-13T22:15:41+0000","dateStarted":"2016-12-13T22:15:41+0000","result":{"code":"SUCCESS","type":"TEXT","msg":""}},{"text":"%pyspark\ndef tweet2row(tweet_str):\n    try:\n        tweet = json.loads(tweet_str)\n        if 'id' in tweet:\n            return (tweet['id'], tweet.get('created_at'),\n                   tweet['user'].get('name'), tweet.get('text'),\n                   tweet.get('favorite_count'), tweet.get('retweet_count'),\n                   json.dumps(tweet.get('entities')) )\n    except:\n        pass","dateUpdated":"2016-12-13T22:18:22+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481666637255_82967972","id":"20161213-220357_1294765775","dateCreated":"2016-12-13T22:03:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6637","dateFinished":"2016-12-13T22:18:22+0000","dateStarted":"2016-12-13T22:18:22+0000","result":{"code":"SUCCESS","type":"TEXT","msg":""},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481667438324_-75027029","id":"20161213-221718_1899246724","dateCreated":"2016-12-13T22:17:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6786","text":"%pyspark\ntweets.map(tweet2row).first()","dateUpdated":"2016-12-13T22:18:41+0000","dateFinished":"2016-12-13T22:18:51+0000","dateStarted":"2016-12-13T22:18:41+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"(806286413268254720, u'Tue Dec 06 23:57:15 +0000 2016', u'\\u304f\\u308d\\u3051\\u3093', u'@ponco_96 \\u306f\\u3084\\u3044', 0, 0, '{\"user_mentions\": [{\"indices\": [0, 9], \"screen_name\": \"ponco_96\", \"id\": 2820353102, \"name\": \"\\\\u307d\\\\u3093\", \"id_str\": \"2820353102\"}], \"symbols\": [], \"hashtags\": [], \"urls\": []}')\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481663386416_-115818037","id":"20161213-210946_1050511476","dateCreated":"2016-12-13T21:09:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6465","dateUpdated":"2016-12-13T22:14:57+0000","dateFinished":"2016-12-13T22:09:54+0000","dateStarted":"2016-12-13T22:09:54+0000","result":{"code":"SUCCESS","type":"TEXT","msg":""},"text":"%pyspark\ncluster = Cluster(['172.31.59.52'])\nsession = cluster.connect()"}],"name":"cassandra","id":"2C3EJSF1V","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}